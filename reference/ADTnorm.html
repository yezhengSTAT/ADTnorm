<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ADTnorm normalization to remove the technical variations across samples for each ADT marker. — ADTnorm • ADTnorm</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="ADTnorm normalization to remove the technical variations across samples for each ADT marker. — ADTnorm"><meta property="og:description" content="This function removes the technical variations such as batch effect, sequencing depth biases, antibody selection difference and antibody concentration differences, etc. The normalized samples are ready for integration across studies."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ADTnorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ADTnorm-tutorial.html">ADTnorm Tutorial</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/yezhengSTAT/ADTnorm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ADTnorm normalization to remove the technical variations across samples for each ADT marker.</h1>
    <small class="dont-index">Source: <a href="https://github.com/yezhengSTAT/ADTnorm/blob/HEAD/R/ADTnorm.R" class="external-link"><code>R/ADTnorm.R</code></a></small>
    <div class="hidden name"><code>ADTnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function removes the technical variations such as batch effect, sequencing depth biases, antibody selection difference and antibody concentration differences, etc. The normalized samples are ready for integration across studies.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ADTnorm</span><span class="op">(</span></span>
<span>  cell_x_adt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_x_feature <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_outpath <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  study_name <span class="op">=</span> <span class="st">"ADTnorm"</span>,</span>
<span>  marker_to_process <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bimodal_marker <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trimodal_marker <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  positive_peak <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bw_smallest_cd3 <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  bw_smallest_cd4 <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  bw_smallest_cd8 <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  bw_smallest_bi <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>  bw_smallest_tri <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  cd3_index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cd4_index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cd8_index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  peak_type <span class="op">=</span> <span class="st">"midpoint"</span>,</span>
<span>  multi_sample_per_batch <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shoulder_valley <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shoulder_valley_slope <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>  valley_density_adjust <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  landmark_align_type <span class="op">=</span> <span class="st">"negPeak_valley_posPeak"</span>,</span>
<span>  midpoint_type <span class="op">=</span> <span class="st">"valley"</span>,</span>
<span>  neg_candidate_thres <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">asinh</a></span><span class="op">(</span><span class="fl">8</span><span class="op">/</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  lower_peak_thres <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  brewer_palettes <span class="op">=</span> <span class="st">"Set1"</span>,</span>
<span>  save_intermediate_rds <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_intermediate_fig <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  detect_outlier_valley <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  target_landmark_location <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clean_adt_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>cell_x_adt</dt>
<dd><p>Matrix of ADT raw counts in cells (rows) by ADT markers (columns) format.</p></dd>


<dt>cell_x_feature</dt>
<dd><p>Matrix of cells (rows) by cell features (columns) such as cell type, sample, and batch-related information.</p></dd>


<dt>save_outpath</dt>
<dd><p>The path to save the results.</p></dd>


<dt>study_name</dt>
<dd><p>Name of this run.</p></dd>


<dt>marker_to_process</dt>
<dd><p>Markers to normalize. Leaving empty to process all the ADT markers in cell_x_adt matrix.</p></dd>


<dt>bimodal_marker</dt>
<dd><p>Specify ADT markers that are likely to have two peaks based on researchers' prior knowledge or preliminary observation of particular data to be processed. Leaving it as default, ADTnorm will try to find the bimodal peak in all markers that are not listed in <code>trimodal_marker.</code></p></dd>


<dt>trimodal_marker</dt>
<dd><p>Index of the ADT markers that tend to have three peaks based on researchers' prior knowledge (e.g., CD4) or preliminary observation on particular data to be processed.</p></dd>


<dt>positive_peak</dt>
<dd><p>A list variable containing a vector of ADT marker(s) and a corresponding vector of sample name(s) in matching order to specify that the uni-peak detected should be aligned to positive peaks. For example, for samples that only contain T cells. The only CD3 peak should be aligned to the positive peaks of other samples.</p></dd>


<dt>bw_smallest_cd3</dt>
<dd><p>The smallest bandwidth parameter value for CD3. Recommend 0.5 or 0.8.</p></dd>


<dt>bw_smallest_cd4</dt>
<dd><p>The smallest bandwidth parameter value for CD4. Recommend 0.5 or 0.8.</p></dd>


<dt>bw_smallest_cd8</dt>
<dd><p>The smallest bandwidth parameter value for CD8. Recommend 0.5 or 0.8.</p></dd>


<dt>bw_smallest_bi</dt>
<dd><p>The smallest bandwidth parameter value for bi-modal peaks. Recommend 1.1.</p></dd>


<dt>bw_smallest_tri</dt>
<dd><p>The smallest bandwidth parameter value for tri-modal peaks. Recommend the same value for CD4, such as 0.5.</p></dd>


<dt>cd3_index</dt>
<dd><p>Index for CD3 marker. If the ADT marker is named "CD3", the program can detect the index automatically. If users named CD3 uniquely, please provide the index for CD3 markers in the column name of cell_x_adt.</p></dd>


<dt>cd4_index</dt>
<dd><p>Index for CD4 marker. If the ADT marker is named "CD4", the program can detect the index automatically. If users named CD4 uniquely, please provide the index for CD4 markers in the column name of cell_x_adt.</p></dd>


<dt>cd8_index</dt>
<dd><p>Index for CD8 marker. If the ADT marker is named "CD8", the program can detect the index automatically. If users named CD8 uniquely, please provide the index for CD8 markers in the column name of cell_x_adt.</p></dd>


<dt>peak_type</dt>
<dd><p>The type of peak to be detected. Select from "midpoint" for setting the peak landmark to the midpoint of the peak region being detected or "mode" for setting the peak landmark to the mode location of the peak. "midpoint" can be generally more robust across samples and less impacted by the bandwidth. "mode" can be more accurate in determining the peak location if the bandwidth is generally ideal for the target marker.</p></dd>


<dt>multi_sample_per_batch</dt>
<dd><p>Set it to TRUE to discard the positive peak that only appear in one sample per batch (sample number is &gt;=3 per batch).</p></dd>


<dt>shoulder_valley</dt>
<dd><p>Indicator to specify whether a shoulder valley is expected in case of the heavy right tail where the population of cells should be considered as a positive population.</p></dd>


<dt>shoulder_valley_slope</dt>
<dd><p>The slope on the ADT marker density distribution to call shoulder valley.</p></dd>


<dt>valley_density_adjust</dt>
<dd><p>Parameter for <code>density</code> function: bandwidth used is adjust*bw. This makes it easy to specify values like ‘half the default’ bandwidth.</p></dd>


<dt>landmark_align_type</dt>
<dd><p>Algin the peak and valleys using one of the "negPeak", "negPeak_valley", "negPeak_valley_posPeak", and "valley" alignment modes.</p></dd>


<dt>midpoint_type</dt>
<dd><p>Fill in the missing first valley by the midpoint of two positive peaks ("midpoint") or impute by other valleys ("valley").</p></dd>


<dt>neg_candidate_thres</dt>
<dd><p>The upper bound for the negative peak. Users can refer to their IgG samples to obtain the minimal upper bound of the IgG sample peak. It can be one of the values of asinh(4/5+1), asinh(6/5+1), or asinh(8/5+1) if the right 95% quantile of IgG samples is large.</p></dd>


<dt>lower_peak_thres</dt>
<dd><p>The minimal ADT marker density height of calling it a real peak. Set it to 0.01 to avoid a suspicious positive peak. Set it to 0.001 or smaller to include some small but tend to be real positive peaks, especially for markers like CD19.</p></dd>


<dt>brewer_palettes</dt>
<dd><p>Set the color scheme of color brewer.</p></dd>


<dt>save_intermediate_rds</dt>
<dd><p>Save the rds file for the intermediate objects.</p></dd>


<dt>save_intermediate_fig</dt>
<dd><p>Save the density plot figure for checking the peak and valley location detection.</p></dd>


<dt>detect_outlier_valley</dt>
<dd><p>Detect outlier valley and impute by the neighbor samples.</p></dd>


<dt>target_landmark_location</dt>
<dd><p>Align the landmarks to a fixed location or, by default, align to the mean across samples for each landmark. The default value is NULL. Setting it to "fixed" will align the negative peak to 1 and the right-most positive peak to 5. Users can also assign a two-element vector indicating the location of the negative and most positive peaks to be aligned.</p></dd>


<dt>clean_adt_name</dt>
<dd><p>Clean the ADT marker name</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">ADTnorm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  cell_x_adt <span class="op">=</span> <span class="va">cell_x_adt</span>,</span></span>
<span class="r-in"><span>  cell_x_feature <span class="op">=</span> <span class="va">cell_x_feature</span>,</span></span>
<span class="r-in"><span>  save_outpath <span class="op">=</span> <span class="va">save_outpath</span>,</span></span>
<span class="r-in"><span>  study_name <span class="op">=</span> <span class="va">study_name</span>,</span></span>
<span class="r-in"><span>  marker_to_process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD3"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ye Zheng.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

